<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="theme-color" content="#1a1a2e"/>
<title>Mo's Wellness App</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;max-width:500px;margin:0 auto;padding:14px 14px 90px;transition:background .3s}
:root{--bg:linear-gradient(135deg,#fff9f0,#f0fff4);--card:#fff;--text:#1a1a2e;--sub:#666;--border:#f0f0f0;--inp:#f5f5f5;--inp-text:#333;--track:#e0e0e0}
.dark{--bg:#0a0a0f;--card:#13131a;--text:#f0ede8;--sub:#9a8fa0;--border:#2a2a3a;--inp:#1a1a24;--inp-text:#f0ede8;--track:#2a2a3a}
.card{background:var(--card);border-radius:20px;padding:16px;margin-bottom:14px;border:1px solid var(--border);box-shadow:0 4px 20px rgba(0,0,0,.08)}
.dark .card{box-shadow:0 4px 20px rgba(0,0,0,.3)}
input,select{background:var(--inp);color:var(--inp-text);border:1px solid var(--border);border-radius:12px;padding:10px 14px;font-size:14px;outline:none;width:100%;font-family:inherit}
button{cursor:pointer;border:none;font-family:inherit;transition:opacity .2s}
button:active{opacity:0.7}

/* Header Elements */
.header{background:linear-gradient(135deg,#1a0a2e 0%,#16213e 50%,#0f3460 100%);padding:24px 16px 16px;border-radius:20px;margin-bottom:14px;position:relative;overflow:hidden;box-shadow:0 4px 15px rgba(0,0,0,0.2)}
.header-circle1{position:absolute;top:-20px;right:-20px;width:120px;height:120px;border-radius:50%;background:rgba(255,255,255,0.05);}
.header-bar{margin-top:14px;background:rgba(255,255,255,0.15);border-radius:12px;padding:10px 14px;backdrop-filter:blur(8px);}
.progress-track{height:6px;background:rgba(255,255,255,0.2);border-radius:3px;margin:6px 0;}
.progress-fill{height:100%;background:linear-gradient(90deg,#f5a623,#fff);border-radius:3px;transition:width .5s;}

/* Buttons & Utils */
.btn-primary{background:linear-gradient(135deg,#00d68f,#3498db);color:#fff;border-radius:14px;padding:13px;font-weight:800;font-size:15px;width:100%;border:none}
.btn-green{background:#00d68f;color:#fff;border-radius:12px;padding:10px 14px;font-weight:700;font-size:13px;border:none;white-space:nowrap}
.btn-gold{background:#f5a623;color:#000;border-radius:12px;padding:10px 14px;font-weight:700;font-size:13px;border:none;}
.btn-danger{background:transparent;border:2px solid #e84545;border-radius:14px;padding:11px;color:#e84545;font-weight:700;font-size:13px;width:100%}
.row{display:flex;align-items:center;gap:8px}
.flex-sb{display:flex;justify-content:space-between;align-items:center;}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}
.pill{border-radius:10px;padding:7px 4px;font-weight:700;font-size:11px;border:none;white-space:nowrap;transition:background .2s}

/* Tab Bar */
.tab-bar{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:500px;background:var(--card);border-top:1px solid var(--border);display:flex;justify-content:space-around;z-index:50;padding:8px 4px 16px}
.tab-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 0;border-radius:12px;background:transparent;color:var(--sub);font-size:9px;font-weight:700;transition:all .2s}
.tab-item.active{color:#00d68f;background:rgba(0,214,143,0.1)}
.tab-item span:first-child{font-size:18px}

/* Progress & Lists */
.prog-bar{background:var(--track);border-radius:20px;overflow:hidden}
.ritual-card{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:14px;margin-bottom:8px;cursor:pointer;border:2px solid transparent;transition:all .2s}
.ritual-card.done{border-color:#00d68f}
.food-row{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--border)}
.stat-box{background:var(--inp);border-radius:12px;padding:10px 6px;text-align:center;border:1px solid var(--border)}
.milestone-row{display:flex;align-items:center;gap:10px;padding:9px 12px;border-radius:14px;margin-bottom:6px;border:2px solid transparent}
.milestone-row.reached{border-color:#00d68f}
.manual-form{background:var(--inp);border-radius:16px;padding:14px;margin-top:10px;border:1px solid var(--border)}
.manual-form input,.manual-form select{margin-bottom:8px}

h2{font-size:17px;color:var(--text);margin-bottom:4px}
h3{font-size:15px;color:var(--text);margin-bottom:10px}
.del-btn{background:none;color:#e84545;font-size:15px;padding:0 8px;font-weight:bold;}

/* Overlays */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:200;display:flex;align-items:center;justify-content:center;padding:24px;}
.milestone-popup{background:#13131a;border:1px solid #f5a623;border-radius:24px;padding:30px;text-align:center;max-width:320px;width:100%;box-shadow:0 10px 30px rgba(245,166,35,0.3)}
</style>
</head>
<body>
<div id="app"></div>
<script>
// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const PROFILE={name:"Mo'",startWeight:70.25,goalWeight:63,heightCm:162.56,age:36,calGoal:1400};
const MILESTONES=[{kg:3,gift:"üõÅ Luxe Bath Ritual",desc:"Treat yourself to a relaxing bath with oils & music"},{kg:6,gift:"üëó New Outfit",desc:"Buy that outfit you've been eyeing!"},{kg:7.25,gift:"üéâ Goal Achieved!",desc:"Full wellness day ‚Äî spa & celebration!"}];
const WATER_OPTS=[{id:"plain",name:"Plain Water",emoji:"üíß"},{id:"lemon",name:"Water & Lemon",emoji:"üçã"},{id:"chia",name:"Water & Chia",emoji:"üå±"},{id:"warm",name:"Warm Water",emoji:"‚ô®Ô∏è"}];

const DEFAULT_RITUALS=[{id:"ginger",name:"Ginger Shot",emoji:"ü´ö",time:"6‚Äì7 AM",note:"Anti-inflammatory"},{id:"coffee",name:"Black Coffee",emoji:"‚òï",time:"7‚Äì8 AM",note:"Focus"},{id:"greentea",name:"Green Tea",emoji:"üçµ",time:"10‚Äì11 AM",note:"Antioxidant"}];
const DEFAULT_BLUEPRINT=[{time:"6‚Äì7 AM",emoji:"ü´ö",text:"Morning rituals (empty stomach)"},{time:"8 AM‚Äì1 PM",emoji:"üíª",text:"Fasting window & Work mode"},{time:"1 PM",emoji:"üçΩÔ∏è",text:"Lunch (Break Fast)"},{time:"7 PM",emoji:"üåô",text:"Dinner & Fasting begins"}];

const NAIJA=[{n:"Jollof Rice",e:"üçö",c:350,ca:58,p:8,f:10},{n:"Egusi Soup",e:"ü•ò",c:420,ca:12,p:22,f:32},{n:"Suya (100g)",e:"üç¢",c:220,ca:5,p:28,f:10},{n:"Moi Moi",e:"üßÜ",c:190,ca:18,p:14,f:7},{n:"Pounded Yam",e:"ü•î",c:300,ca:72,p:3,f:1},{n:"Fried Plantain",e:"üçå",c:240,ca:50,p:2,f:5},{n:"Zobo Drink",e:"ü•§",c:60,ca:15,p:0,f:0}];
const GLOBAL=[{n:"Egg (1 large)",e:"ü•ö",c:78,ca:1,p:6,f:5},{n:"Chicken Breast 100g",e:"üçó",c:165,ca:0,p:31,f:4},{n:"Avocado (half)",e:"ü•ë",c:120,ca:6,p:2,f:11},{n:"Oats 1cup",e:"ü•£",c:150,ca:27,p:5,f:3},{n:"Brown Rice 1cup",e:"üåæ",c:215,ca:45,p:5,f:2}];
const ALL_FOODS=[...NAIJA,...GLOBAL];
const QUOTES=[`You're crushing it, ${PROFILE.name}! üí™`,"Naija girl strong! üá≥üá¨üî•","Small steps, big results! üåü","63kg loading... üì¶üíö","Consistency is your superpower! ‚ö°"];

// ‚îÄ‚îÄ STORAGE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const save=(k,v)=>{try{localStorage.setItem('mo_'+k,JSON.stringify(v))}catch(e){}};
const load=(k,def)=>{try{const v=localStorage.getItem('mo_'+k);return v!==null?JSON.parse(v):def}catch(e){return def}};
function today(){return new Date().toLocaleDateString('en-NG',{day:'numeric',month:'short',year:'numeric'});}

let savedFood = load('foodLog',{"Breakfast":[],"Lunch":[],"Dinner":[],"Snack":[]});
if(!savedFood["Breakfast"]) savedFood = {"Breakfast":[],"Lunch":[],"Dinner":[],"Snack":[]};

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let state={
  dark:load('dark',true), tab:0,
  
  // Meals
  foodLog:savedFood, activeMeal:"Breakfast", foodSearch:"", foodFilter:"All", showFoodSearch:false,
  showManualFood:false, manualFood:{name:"",emoji:"üçΩÔ∏è",cal:"",carbs:"",protein:"",fat:""},
  
  // Editable Plans
  myRituals:load('myRituals', DEFAULT_RITUALS), ritualsChecked:load('ritualsChecked_'+today(),{}),
  showAddRitual:false, newRitual:{name:"", emoji:"‚ú®", time:"", note:""},
  myBlueprint:load('myBlueprint', DEFAULT_BLUEPRINT),
  showAddBlueprint:false, newBlueprint:{time:"", emoji:"üïí", text:""},

  // Trackers
  sleepLog:load('sleepLog',[]), sleepInput:"",
  steps:load('steps_'+today(), 0), stepsInput:"", stepsGoal:8000,
  waterType:"plain", glasses:load('glasses_'+today(),0), waterGoal:load('waterGoal',8), hydrationLog:load('hydrationLog_'+today(),[]),
  showManualWater:false, manualWater:{name:"",emoji:"üíß"},
  exercises:load('exercises_'+today(),[]), showManualExercise:false, manualExercise:{name:"",emoji:"üèÉ",mins:"",cal:""},
  
  // Fasting & Weight
  ifActive:load('ifActive',false), ifStart:load('ifStart',null), ifHistory:load('ifHistory',[]),
  weightLog:load('weightLog',[{date:"Start",weight:PROFILE.startWeight,id:0}]),
  weightInput:"", milestone:null, quote:QUOTES[Math.floor(Math.random()*QUOTES.length)]
};

// ‚îÄ‚îÄ COMPUTED ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function totalCals(){const allFoods=[].concat(...Object.values(state.foodLog)); return allFoods.reduce((s,f)=>s+f.c,0) + Object.keys(state.ritualsChecked).length*5;}
function burnedCals(){return state.exercises.reduce((s,e)=>s+e.burned,0);}
function latestWeight(){return state.weightLog[state.weightLog.length-1]?.weight??PROFILE.startWeight;}
function totalLost(){return Math.max(0,+(PROFILE.startWeight-latestWeight()).toFixed(2));}
function pctGoal(){return Math.min(100,Math.max(0,(totalLost()/(PROFILE.startWeight-PROFILE.goalWeight))*100));}

// Live Fasting Clock Math
function ifElapsedHours(){if(!state.ifStart)return 0;return ((Date.now()-state.ifStart)/3600000);}
function ifElapsedFormatted(){
  if(!state.ifStart) return "00:00:00";
  let diff = Math.floor((Date.now()-state.ifStart)/1000);
  let h = Math.floor(diff/3600).toString().padStart(2,'0');
  let m = Math.floor((diff%3600)/60).toString().padStart(2,'0');
  let s = (diff%60).toString().padStart(2,'0');
  return `${h}:${m}:${s}`;
}

// ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function r(){
  document.getElementById('app').innerHTML=render();
  setTimeout(()=>{ if(document.getElementById('weightChart')) drawWeightChart(); }, 0);
}

function render(){
  document.body.className=state.dark?'dark':'';
  const tabs=["üè†","üçΩÔ∏è","üíß","‚è±Ô∏è","üìã","üìä"];
  const tabLabels=["Home","Food","Hydrate","Fast","Plan","Stats"];
  
  return`
    ${state.milestone?renderMilestonePopup():''}
    
    <div class="header">
      <div class="header-circle1"></div>
      <div class="flex-sb" style="position:relative;z-index:10">
        <div>
          <div style="font-size:11px;color:rgba(255,255,255,0.7);font-weight:600;letter-spacing:1px;text-transform:uppercase">Welcome back</div>
          <div style="font-size:26px;font-weight:900;color:#fff">${PROFILE.name} üåü</div>
          <div style="font-size:11px;color:rgba(255,255,255,0.8);margin-top:2px">${new Date().toLocaleDateString('en-NG',{weekday:'long',day:'numeric',month:'short'})}</div>
        </div>
        <button onclick="toggleDark()" style="background:rgba(255,255,255,0.2);border:none;border-radius:50%;width:36px;height:36px;font-size:16px;color:#fff">${state.dark?'‚òÄÔ∏è':'üåô'}</button>
      </div>
      <div class="header-bar" style="position:relative;z-index:10">
        <div style="font-size:11px;color:rgba(255,255,255,0.9)">Journey: ${PROFILE.startWeight}kg ‚Üí ${PROFILE.goalWeight}kg</div>
        <div class="progress-track"><div class="progress-fill" style="width:${pctGoal()}%"></div></div>
        <div class="flex-sb" style="font-size:10px;color:rgba(255,255,255,0.9)">
          <span>Lost: <strong style="color:#f5a623">${totalLost()}kg</strong></span>
          <span>Left: ${Math.max(0, latestWeight() - PROFILE.goalWeight).toFixed(2)}kg</span>
        </div>
      </div>
    </div>

    ${[renderHome,renderFood,renderHydration,renderIF,renderPlan,renderStats][state.tab]()}
    
    <nav class="tab-bar">
      ${tabs.map((t,i)=>`<button class="tab-item${state.tab===i?' active':''}" onclick="setTab(${i})"><span>${t}</span><span>${tabLabels[i]}</span></button>`).join('')}
    </nav>`;
}

// ‚îÄ‚îÄ 1. HOME TAB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderHome(){
  const ritTotal = state.myRituals.length;
  const ritDone = state.myRituals.filter(rt => state.ritualsChecked[rt.id]).length;
  const ritPct = ritTotal > 0 ? (ritDone/ritTotal)*100 : 0;
  const stepsPct = Math.min(100, (state.steps/state.stepsGoal)*100);

  return`
  <div style="background:var(--card2);border:1px solid var(--border);border-radius:16px;padding:12px;margin-bottom:14px;text-align:center">
    <p style="color:var(--text);font-weight:700;font-size:13px">${state.quote}</p>
  </div>
  
  <div class="card">
    <div class="flex-sb" style="margin-bottom:6px">
      <h3 style="margin:0">üåÖ Today's Rituals</h3>
      <span style="font-size:11px;color:#00d68f;font-weight:700">${Math.round(ritPct)}%</span>
    </div>
    <div class="prog-bar" style="height:6px;margin-bottom:14px"><div class="prog-fill" style="width:${ritPct}%;background:#00d68f"></div></div>
    
    ${state.myRituals.map((rt, i)=>{
      const done=state.ritualsChecked[rt.id];
      return`<div class="ritual-card${done?' done':''}" style="background:${done?'rgba(0,214,143,0.1)':'var(--inp)'}" onclick="toggleRitual('${rt.id}')">
      <span style="font-size:24px">${rt.emoji}</span>
      <div style="flex:1"><div style="font-weight:700;font-size:13px">${rt.name}</div><div style="font-size:10px;color:var(--sub)">${rt.time}</div></div>
      <button onclick="event.stopPropagation(); removeRitual(${i})" class="del-btn">‚úï</button>
      <span style="font-size:18px;margin-left:4px">${done?'‚úÖ':'‚≠ï'}</span>
    </div>`;}).join('')}
    
    ${state.showAddRitual ? `
    <div class="manual-form">
      <input placeholder="Name (e.g. Green Tea)" oninput="state.newRitual.name=this.value"/>
      <div class="row" style="gap:8px">
        <input placeholder="Emoji üçµ" style="width:70px;text-align:center" oninput="state.newRitual.emoji=this.value"/>
        <input placeholder="Time (e.g. 10 AM)" oninput="state.newRitual.time=this.value"/>
      </div>
      <div class="row" style="gap:8px">
        <button class="btn-green" onclick="addRitual()" style="flex:1">Save</button>
        <button onclick="setState('showAddRitual',false)" style="background:var(--card);color:var(--sub);padding:8px;border-radius:10px;font-weight:700;font-size:12px;border:1px solid var(--border)">Cancel</button>
      </div>
    </div>` : `<button onclick="setState('showAddRitual',true)" style="width:100%;padding:10px;background:transparent;border:1px dashed var(--sub);color:var(--text);border-radius:12px;font-size:12px;font-weight:700;margin-top:4px">+ Add Custom Ritual</button>`}
  </div>

  <div class="grid2">
    <div class="card" style="margin-bottom:14px">
      <h3 style="margin-bottom:4px">üò¥ Sleep</h3>
      <p style="font-size:10px;color:var(--sub);margin-bottom:8px">Rest = fat loss</p>
      <div class="row" style="gap:4px;margin-bottom:8px">
        <input type="number" placeholder="Hrs (e.g. 7.5)" value="${state.sleepInput}" oninput="state.sleepInput=this.value" style="padding:8px;font-size:12px"/>
        <button onclick="logSleep()" class="btn-primary" style="padding:8px;font-size:12px;width:auto">Log</button>
      </div>
      ${state.sleepLog.length>0 ? `<div style="font-size:11px;color:var(--sub)">Last night: <strong style="color:#3498db">${state.sleepLog[state.sleepLog.length-1].hrs}h</strong></div>` : ''}
    </div>
    <div class="card" style="margin-bottom:14px">
      <h3 style="margin-bottom:4px">üëü Steps</h3>
      <p style="font-size:10px;color:var(--sub);margin-bottom:8px">${
